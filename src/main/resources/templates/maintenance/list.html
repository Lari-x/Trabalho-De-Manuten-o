<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Solicitações de Manutenção</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css"
      rel="stylesheet"
    />
    <style>
      body {
        background-color: #f8f9fa;
      }
      .card {
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      }
      .table-hover tbody tr:hover {
        background-color: #eef4ff;
      }
    </style>
  </head>
  <body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary mb-4">
      <div class="container">
        <a class="navbar-brand fw-bold" href="#">Sistema de Manutenção</a>
        <a th:href="@{/manutencao/criar}" class="btn btn-light btn-sm">
          <i class="bi bi-plus-circle"></i> Nova Solicitação
        </a>
      </div>
    </nav>

    <main class="container">
      <div class="card p-4">
        <h2 class="mb-3">Lista de Solicitações</h2>

        <table
          class="table table-striped table-hover align-middle"
          th:unless="${#lists.isEmpty(requests)}"
        >
          <thead class="table-primary">
            <tr>
              <th>#</th>
              <th>Solicitante</th>
              <th>Descrição</th>
              <th>Data Solicitação</th>
              <th>Data Finalização</th>
              <th>Ações</th>
            </tr>
          </thead>
          <tbody>
            <tr th:each="request : ${requests}">
              <td th:text="${request.id}">---</td>
              <td th:text="${request.requesterName}">---</td>
              <td th:text="${request.problemDescription}">---</td>
              <td
                th:text="${#temporals.format(request.requestTimestamp, 'dd/MM/yyyy HH:mm')}"
              >
                ---
              </td>
              <td
                th:text="${request.finishedTimestamp != null ? #temporals.format(request.finishedTimestamp, 'dd/MM/yyyy HH:mm') : '-'}"
              >
                ---
              </td>
              <td>
                <form
                  class="d-inline"
                  th:action="@{/manutencao/finalizar/{id}(id=${request.id})}"
                  method="POST"
                >
                  <button
                    type="submit"
                    class="btn btn-sm btn-success"
                    th:classappend="${request.finishedTimestamp} ? 'disabled' : ''"
                  >
                    <i class="bi bi-check-circle"></i> Finalizar
                  </button>
                </form>
                <a
                  th:href="@{/manutencao/excluir/{id}(id=${request.id})}"
                  class="btn btn-sm btn-danger"
                >
                  <i class="bi bi-trash"></i> Excluir
                </a>
              </td>
            </tr>
          </tbody>
        </table>

        <p class="text-muted" th:if="${#lists.isEmpty(requests)}">
          Nenhuma solicitação cadastrada.
        </p>
      </div>
    </main>
  </body>
</html>
